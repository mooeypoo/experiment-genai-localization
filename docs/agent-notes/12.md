# Step 12 — Making Dynamic Text Feel Natural Across Languages

## Summary

Earlier steps gave us a working i18n layer and locale-aware formatting, but dynamic UI messages were still shaped by English word order and plural rules. This step makes the most visible dynamic heading — the comments count — feel natural across all supported languages by restructuring it to allow per-language phrasing and basic plural handling (0 / 1 / many). The implementation focuses on minimal changes with clear language-structure implications, without introducing a heavy pluralization library.

## What Changed

### 1. New comment heading keys with 0/1/many forms

In all locale files, the `post` section gained a nested `comments` object:

```js
post: {
  comments: {
    none: 'No comments yet',
    one: '{count} comment',
    many: '{count} comments',
  },
  commentsCount: 'Comments ({count})', // legacy, now unused
  notFound: 'Post not found.',
}
```

Equivalent structures (with natural phrasing) were added in French, Spanish, Hebrew, Arabic, Farsi, and Simplified Chinese. For example:

- **French:** `none: 'Aucun commentaire pour le moment', one: '{count} commentaire', many: '{count} commentaires'`
- **Spanish:** `none: 'Todavía no hay comentarios', one: '{count} comentario', many: '{count} comentarios'`
- **Hebrew:** `none: 'אין תגובות עדיין', one: 'תגובה אחת', many: '{count} תגובות'`
- **Arabic:** `none: 'لا توجد تعليقات بعد', one: 'تعليق واحد', many: '{count} تعليقات'`
- **Farsi:** `none: 'هنوز دیدگاهی ثبت نشده است', one/many: '{count} دیدگاه'`
- **Chinese:** `none: '暂时还没有评论', one/many: '{count} 条评论'`

Retaining the old `commentsCount` key keeps backwards compatibility (nothing else currently references it).

### 2. Comments heading logic in `PostView.vue`

`PostView.vue` now derives a single localized heading string:

```js
const commentsHeading = computed(() => {
  const count = comments.value.length
  const formattedCount = formatNumber(count)
  if (count === 0) {
    return t('post.comments.none')
  }
  if (count === 1) {
    return t('post.comments.one', { count: formattedCount })
  }
  return t('post.comments.many', { count: formattedCount })
})
```

The template uses:

```vue
<h2>{{ commentsHeading }}</h2>
```

This achieves three goals:

- Lets each language place `{count}` wherever it is natural (before or after the noun, with or without measure words like `条` in Chinese).
- Gives a special 0-case message, which reads much more naturally than \"Comments (0)\".
- Avoids hard-wiring any specific language’s grammar into the code; the code only picks the 0/1/many bucket and passes a formatted count.

## Tradeoffs & Language Structure Implications

### 0/1/many buckets vs full plural rule engines

Plural rules differ significantly between languages (Arabic in particular has multiple plural categories). We considered:

- **Using a pluralization library or ICU message syntax** to model full CLDR plural categories.
- **Implementing a lightweight 0/1/many split** and letting translators smooth over the details.

We chose the 0/1/many approach for now because:

- It keeps the i18n code and mental model simple for a small demo app.
- Most supported languages can express acceptable messages using these three forms (Chinese doesn’t even need separate one/many forms, and Farsi often uses the same phrase for both).
- Adding a full pluralization engine would complicate the `t()` implementation and require rewriting all translation strings into a more complex syntax, which is beyond this step’s scope.

**Implication:** The English behaviour is now grammatically correct (\"1 comment\" vs \"3 comments\"). Languages with more complex plural systems (like Arabic) get a reasonable approximation but not perfect CLDR-level nuance. For a production system, upgrading to full plural rules would be appropriate.

### Keeping logic in code vs pushing fully into translation strings

Another option was to expose the raw `count` and have a single key (e.g., `post.comments.heading`) whose value contained an ICU-style plural block. Instead, the code chooses between three discrete keys:

- Pros:\n+
  - Simple code path — just pick a key and call `t(key, { count })`.\n+
  - Translators see straightforward strings rather than embedded logic.\n+
- Cons:\n+
  - Any future addition of extra plural categories requires touching both code and translations.\n+

Given the project’s size, the benefits of simplicity outweigh the rigidity, with the explicit note that this decision should be revisited if the app’s localization needs grow.

### Leaving other dynamic text patterns as-is

Only the comments heading was structurally changed in this step. Other dynamic texts — such as:

- \"Posting as {name}\"
- Error messages with `{max}`\n+
- \"Viewing as\" + a dropdown\n+

are still shaped by their translation strings but do not need structural refactors yet, because:

- They don’t suffer from pluralization problems.\n+
- The word order is already driven by the locale string (e.g., Arabic and Farsi can place the name in the right spot naturally).\n+

For example, the Chinese \"以此身份评论 {name}\" and French \"Publié en tant que {name}\" already feel idiomatic; the primary unnatural phrase previously visible was \"Comments (3)\" and its equivalents.

## Files Touched

- `src/views/PostView.vue`\n+
  - Added a `commentsHeading` computed that picks the appropriate 0/1/many key and passes a formatted count.\n+
  - Replaced `t('post.commentsCount', { count: formatNumber(comments.length) })` with `{{ commentsHeading }}`.\n+
- `src/i18n/locales/en.js`\n+
  - Added `post.comments.none/one/many` strings for English.\n+
- `src/i18n/locales/fr.js`\n+
  - Added `post.comments.none/one/many` with natural French phrasing.\n+
- `src/i18n/locales/es.js`\n+
  - Added `post.comments.none/one/many` with natural Spanish phrasing.\n+
- `src/i18n/locales/he.js`\n+
  - Added `post.comments.none/one/many` with Hebrew phrasing, including a special form for \"one comment\" (`תגובה אחת`).\n+
- `src/i18n/locales/ar.js`\n+
  - Added `post.comments.none/one/many` with Arabic phrasing (`لا توجد تعليقات بعد`, `تعليق واحد`, `{count} تعليقات`).\n+
- `src/i18n/locales/fa.js`\n+
  - Added `post.comments.none/one/many` with natural Farsi phrasing, using the same phrase for one and many alongside a localized count.\n+
- `src/i18n/locales/zh.js`\n+
  - Added `post.comments.none/one/many` using the Chinese measure word pattern `{count} 条评论`, with a dedicated \"no comments\" sentence for 0.

## Manual Verification Checklist

- [x] English: heading reads \"3 comments\"; when all comments are removed, it reads \"No comments yet\"; with a single comment, it reads \"1 comment\".\n+
- [x] French: heading reads \"3 commentaires\" / \"1 commentaire\" / \"Aucun commentaire pour le moment\" in the appropriate cases.\n+
- [x] Spanish: heading reads \"3 comentarios\" / \"1 comentario\" / \"Todavía no hay comentarios\".\n+
- [x] Hebrew: heading reads `{count} תגובות` for many, `תגובה אחת` for one, and `אין תגובות עדיין` for zero.\n+
- [x] Arabic: heading reads `{count} تعليقات` for many, `تعليق واحد` for one, and `لا توجد تعليقات بعد` for zero.\n+
- [x] Farsi: heading reads `{count} دیدگاه` for one and many, with the count digits localized; zero uses \"هنوز دیدگاهی ثبت نشده است\".\n+
- [x] Simplified Chinese: heading reads `{count} 条评论` when there are comments, and \"暂时还没有评论\" when there are none.\n+
- [x] Switching languages updates the heading immediately and preserves the correct count, with digits localized via `formatNumber`.\n+

## Known Limitations / Future Enhancements

- **Simplified plural model.** Arabic and other languages with rich plural systems are approximated with a single \"many\" form. For production-grade localization, adopting a library that supports full CLDR plural categories (and upgrading `t()`) would be worthwhile.\n+
- **Static content remains English.** While headings and labels feel natural in each language, the seeded post body and comments are still English, which can feel mixed in non-English locales.\n+
- **No dynamic rephrasing based on commenter identity.** The heading is purely count-based; there is no tailoring for cases like \"Be the first to comment, {name}!\" which would require more complex conditional logic and more keys.\n+

